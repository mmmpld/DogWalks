function fillUserLocation(){interval=setInterval(fillUserLocationInterval,100),intervalGPS=setInterval(fillUserLocationGPSInterval,100)}function fillUserLocationInterval(){"undefined"!=typeof userPos.Address?($("#LocationSearchInput").val(userPos.Address),$("#LocationSearchAddressDefault").val(userPos.Address),clearInterval(interval)):intervalCount>20?clearInterval(interval):++intervalCount}function fillUserLocationGPSInterval(){"undefined"!=typeof userPos.Lat&&"undefined"!=typeof userPos.Lng?($("#LocationSearchLat").val(userPos.Lat),$("#LocationSearchLng").val(userPos.Lng),clearInterval(intervalGPS)):intervalCountGPS>20?clearInterval(intervalGPS):++intervalCountGPS}function setUserAddress(e){userPos.Address=makeUserPosAddressString(e),$.cookie("Address",userPos.Address,{expires:90,path:"/"})}function makeUserPosAddressString(e){for(var t=new Array("administrative_area_level_1","sublocality","locality"),n=0;n<e.length;n++)for(var o=0;o<e[n].address_components.length;o++)for(var r=0;r<e[n].address_components[o].types.length;r++)if($.inArray(e[n].address_components[o].types[r],t)>-1)return e[n].address_components[o].short_name}function addressFromGeocode(e,t,n){var o=new google.maps.LatLng(e,t),r=new google.maps.Geocoder;r.geocode({latLng:o},function(e,t){t==google.maps.GeocoderStatus.OK?e?n(e):console.log("No results found"):console.log("Geocoder failed due to: "+t)})}function geocodeFromAddress(e,t){var n=new google.maps.Geocoder;n.geocode({address:e,region:"NZ"},function(n,o){if(o==google.maps.GeocoderStatus.OK){var r=n[0].geometry.location,a=new Array;return a.Lat=r.lat(),a.Lng=r.lng(),t(a)}console.log("Geocode for "+e+" was not successful for the following reason: "+o)})}function exifGPSToDecimal(e,t,n,o){var r=e+(t/60+n/3600);return"S"==o||"W"==o?-r:r}var userPos={},interval,intervalCount=0,intervalGPS,intervalCountGPS=0;jQuery(document).ready(function(e){function t(t){userPos.Lat=t.Lat,userPos.Lng=t.Lng,e.cookie("Lat",userPos.Lat,{expires:90,path:"/"}),e.cookie("Lng",userPos.Lng,{expires:90,path:"/"})}function n(){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(t){userPos.Lat=t.coords.latitude,userPos.Lng=t.coords.longitude,e.cookie("Lat",userPos.Lat,{expires:90,path:"/"}),e.cookie("Lng",userPos.Lng,{expires:90,path:"/"}),addressFromGeocode(userPos.Lat,userPos.Lng,setUserAddress)},function(){o(!0)}):o(!1)}function o(e){}userPos.Lat=e.cookie("Lat"),userPos.Lng=e.cookie("Lng"),userPos.Address=e.cookie("Address"),userPos.Lat&&userPos.Lng||(userPos.Address?geocodeFromAddress(userPos.Address,t):n()),userPos.Address||userPos.Lat&&userPos.Lng&&addressFromGeocode(userPos.Lat,userPos.Lng,makeUserPosAddressString)});